# Mosquitto Configuration - WebSocket Support
# Add these lines to your existing /etc/mosquitto/mosquitto.conf

# ============================================
# Standard MQTT Listener (TCP) - Port 1883
# ============================================
listener 1883
allow_anonymous false
password_file /etc/mosquitto/passwd

# ============================================
# WebSocket Listener - Port 8083
# Required for React Native app
# ============================================
listener 8083
protocol websockets
allow_anonymous false
password_file /etc/mosquitto/passwd

# ============================================
# Optional: Secure WebSocket (WSS) - Port 8084
# For production use with SSL certificates
# ============================================
# listener 8084
# protocol websockets
# allow_anonymous false
# password_file /etc/mosquitto/passwd
# cafile /etc/mosquitto/certs/ca.crt
# certfile /etc/mosquitto/certs/server.crt
# keyfile /etc/mosquitto/certs/server.key

# ============================================
# General Settings
# ============================================
# Logging
log_dest file /var/log/mosquitto/mosquitto.log
log_type error
log_type warning
log_type notice
log_type information

# Connection settings
max_connections -1
max_inflight_messages 20
max_queued_messages 1000

# Persistence
persistence true
persistence_location /var/lib/mosquitto/

# ============================================
# Installation Instructions:
# ============================================
# 1. SSH into server: ssh user@172.105.98.123
# 2. Backup existing config: sudo cp /etc/mosquitto/mosquitto.conf /etc/mosquitto/mosquitto.conf.backup
# 3. Add the WebSocket listener section above to your existing config
# 4. Restart Mosquitto: sudo systemctl restart mosquitto
# 5. Verify: sudo netstat -tlnp | grep 8083
# 6. Test: mosquitto_pub -h 172.105.98.123 -p 8083 -t /test -m "test" -u doze -P bK67ZwBHSWkl --websockets



